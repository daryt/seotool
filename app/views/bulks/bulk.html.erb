

<div class="row">
  <div class="col-md-offset-1 col-md-6">
  <div class="row">
    <h1>Add a New SEO Template</h1>
    <p>Complete the form to add a new template to the database</p>
  </div>
   <form action="/bulk" method="post">
    <div class='form-select'>
      <div class="form-group">
        <label for="bulk[customer]">Customer</label>
        <select class="customer1" name="bulk[customer]">
          <option value="new customer">New Customer</option>
          <%= @customers.each do |customer| %>
            <option class="customer1" value="<%= customer.id %>"><%= customer.name %></option>
            <% end %>
          </select>
      </div>
      <div class="form-group">
        <label for="bulk[customer]">New Customer</label>
        <% customer_name = flash[:customer].present? ? flash[:customer] : nil %>
        <input type="string" class="form-control" id="customer" placeholder="Customer" name="bulk[customer]" value='<%=customer_name %>'> 
      </div>
    </div>

    <div class='form-select'>
      <div class="form-group">
        <label for="bulk[template]">Template</label>
        <select class="template1" name="bulk[template]">
          <option value="new template">New Template</option>
          <%= @templates.each do |template| %>
            <option class="template1" value="<%= template.id %>"><%= template.name %></option>
            <% end %>
          </select>
      </div>
      <div class="form-group">
        <label for="bulk[template]">New Template</label>
        <% template_name = flash[:template].present? ? flash[:template] : nil %>
        <input type="string" class="form-control" id="template" placeholder="Customer" name="bulk[template]" value='<%=template_name %>'> 
      </div>
    </div>

    <div class='form-select'>
      <div class="form-group">
        <label for="bulk[industry]">Industry</label>
        <select class="industry1" name="bulk[industry]">
          <option value="new industry">New Industry</option>
          <%= @industries.each do |industry| %>
            <option class="industry1" value="<%= industry.id %>"><%= industry.name %></option>
            <% end %>
          </select>
      </div>
      <div class="form-group">
        <label for="bulk[industry]">Industry</label>
        <% industry_name = flash[:industry].present? ? flash[:industry] : nil %>
        <input type="string" class="form-control" id="industry" placeholder="Industry" name="bulk[industry]" value='<%=industry_name %>'>
      </div>
    </div>
  
      <%= render "bulktopics" %>

      <script>
        url = "/bulk_topics/";
        url += "<%= escape_javascript(industry_name)%>"
        $.get(url);
      </script>

      <div class="form-group">
      <label for="bulk[topic]">Topic</label>
      <% topic_name = flash[:topic].present? && flash[:success].blank? ? flash[:topic] : nil %>
      <input type="string" class="form-control" placeholder="Topic" id="topic" name="bulk[topic]" value='<%=topic_name %>'>  
    </div>
    <div class="form-group">
      <label for="bulk[title]">Page Title</label>
      <% page_title = flash[:page_title].present? && flash[:success].blank? ? flash[:page_title] : nil %>
      <input type="string" class="form-control" placeholder="title" name="bulk[title]" value='<%=page_title %>'>  
    </div>
    <div class="form-group">
      <label for="bulk[keyword1]">Keyword 1</label>
      <% keyword1 = flash[:keyword1].present? && flash[:success].blank? ? flash[:keyword1] : nil %>
      <input type="string" class="form-control" placeholder="Keyword 1" name="bulk[keyword1]" value='<%=keyword1 %>'>  
    </div>
     <div class="form-group">
      <label for="bulk[keyword2]">Keyword 2</label>
      <% keyword2 = flash[:keyword2].present? && flash[:success].blank? ? flash[:keyword2] : nil %>
      <input type="string" class="form-control" placeholder="Keyword 2" name="bulk[keyword2]" value='<%=keyword2 %>'>  
    </div>
     <div class="form-group">
      <label for="bulk[keyword3]">Keyword 3</label>
      <% keyword3 = flash[:keyword3].present? && flash[:success].blank? ? flash[:keyword3] : nil %>
      <input type="string" class="form-control" placeholder="Keyword 3" name="bulk[keyword3]" value='<%=keyword3 %>'>  
    </div>
    <div class="form-group">
      <label for="bulk[heading1]">Heading 1</label>
      <% heading1 = flash[:heading1].present? && flash[:success].blank? ? flash[:heading1] : nil %>
      <input type="string" class="form-control" placeholder="Heading 1" name="bulk[heading1]" value='<%=heading1 %>'>  
    </div>
     <div class="form-group">
      <label for="bulk[heading2]">Heading 2</label>
      <% heading2 = flash[:heading2].present? && flash[:success].blank? ? flash[:heading2] : nil %>
      <input type="string" class="form-control" placeholder="Heading 2" name="bulk[heading2]" value='<%=heading2 %>'>  
    </div>
     <div class="form-group">
      <label for="bulk[heading3]">Heading 3</label>
      <% heading3 = flash[:heading3].present? && flash[:success].blank? ? flash[:heading3] : nil %>
      <input type="string" class="form-control" placeholder="Heading 3" name="bulk[heading3]" value='<%=heading3 %>'>  
    </div>
    <div class="form-group">
      <label for="bulk[meta]">Meta Description</label>
      <% meta = flash[:meta].present? && flash[:success].blank? ? flash[:meta] : nil %>
      <textarea class="form-control" style='resize:none' placeholder="Meta Description" name="bulk[meta]" rows='3'><%=meta %></textarea>
    </div>
    <div class="form-group">
      <label for="bulk[url]">URL</label>
      <% url = flash[:url].present? && flash[:success].blank? ? flash[:url] : nil %>
      <input type="string" class="form-control" placeholder="URL" name="bulk[url]" value='<%=url %>'> 
    </div>
    <div class="form-group">
      <label for="bulk[state]">State</label>
      <select class="state1" name="bulk[state]">
        <option value="new state">New State</option>
        <%= @states.each do |state| %>
          <option class="state1" value="<%= state.id %>"><%= state.name %></option>
          <% end %>
        </select>
    </div>
    <div class="form-group">
      <label for="bulk[state]">State</label>
      <% state = flash[:state].present? && flash[:success].blank? ? flash[:state] : nil %>
      <input type="string" class="form-control" id="state" placeholder="State" name="bulk[state]" value='<%=state %>'>  
    </div>
     <div class="form-group">
      <label for="bulk[city]">City</label>
      <select class="city1" name="bulk[city]">
        <option value="new city">New City</option>
        <%= @cities.each do |city| %>
          <option class="city1" value="<%= city.id %>"><%= city.name %></option>
          <% end %>
        </select>
    </div>
    <div class="form-group">
      <label for="bulk[city]">City</label>
      <% city = flash[:city].present? && flash[:success].blank? ? flash[:city] : nil %>
      <input type="string" class="form-control" id="city" placeholder="City" name="bulk[city]" value='<%=city %>'>  
    </div>
    
    <input name="authenticity_token" value="<%= form_authenticity_token %>" type="hidden">
    <input type="submit" class="btn btn-default" value="Create">
    </form>
  </div>
  <div class='col-md-4 warning'>
    <% 
      if flash[:errors].present?
         flash[:errors].each do |message|
    %>
      <p><%= message %></p>
      <% end %>
    <% end %>
    <% if flash[:success].present? %>
      <p><%= flash[:success] %></p>
      <% end %>
  </div>
</div>
  <script>

  $(document).ready(function(){

    $('input.form-control').each(function(){
      // console.log($(this).val());
      if ($(this).val())
      {
        // console.log($(this).val());
        // $(this).parent().siblings('.form-select select option[value="' + $(this).val() + '"]').prop('selected',true);
        var out = $(this).parents('.form-select').find('select option:contains("' + $(this).val() + '")').prop('selected',true);
        // console.log(out);
      }
    })

  });


  $(".customer1").change(function() {
    customer = $("select.customer1 option:selected").text();
    $("#customer").val(customer);
    console.log(customer)
  });
  
  $(".template1").change(function() {
    template = $("select.template1 option:selected").text();
    $("#template").val(template);
    console.log(template)
  });
  $(".city1").change(function() {
    city = $("select.city1 option:selected").text();
    $("#city").val(city);
    console.log(city)
  });
  $(".state1").change(function() {
    state = $("select.state1 option:selected").text();
    $("#state").val(state);
    console.log(state)
  });


  $(".industry1").change(function() {
    industry = $("select.industry1 option:selected").text();
    $("#industry").val(industry);
    console.log(industry)
    url="";
    url += "/bulk_topics/";
    url += industry
    $.get(url);
  });

  //  $(".topic1").change(function() {
  //   topic = $("select.topic1 option:selected").text();
  //   $("#topic").val(topic);
  //   console.log(topic)
  // });
</script>